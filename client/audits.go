// DO NOT MODIFY: This file is generated by tools/generate.js. Any changes will be overwritten during the next build.

package client

import (
	"fmt"
	"reflect"

	"github.com/google/jsonapi"
	rootlygo "github.com/rootlyhq/terraform-provider-rootly/v2/schema"
)

type Audit struct {
	ID            string                 `jsonapi:"primary,audits"`
	Event         string                 `jsonapi:"attr,event,omitempty"`
	ItemType      string                 `jsonapi:"attr,item_type,omitempty"`
	Object        map[string]interface{} `jsonapi:"attr,object,omitempty"`
	ObjectChanges map[string]interface{} `jsonapi:"attr,object_changes,omitempty"`
	UserId        int                    `jsonapi:"attr,user_id,omitempty"`
	ItemId        string                 `jsonapi:"attr,item_id,omitempty"`
	Id            int                    `jsonapi:"attr,id,omitempty"`
}

func (c *Client) ListAudits(params *rootlygo.ListAuditsParams) ([]interface{}, error) {
	req, err := rootlygo.NewListAuditsRequest(c.Rootly.Server, params)
	if err != nil {
		return nil, fmt.Errorf("Error building request: %w", err)
	}

	resp, err := c.Do(req)
	if err != nil {
		return nil, fmt.Errorf("Failed to make request: %w", err)
	}

	audits, err := jsonapi.UnmarshalManyPayload(resp.Body, reflect.TypeOf(new(Audit)))
	if err != nil {
		return nil, fmt.Errorf("Error unmarshalling: %w", err)
	}

	return audits, nil
}
